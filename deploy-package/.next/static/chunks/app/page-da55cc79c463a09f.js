(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{5494:(e,s,t)=>{"use strict";t.d(s,{A:()=>c});var r=t(5155),a=t(2115),i=t(6874),n=t.n(i),l=t(2108),d=t(5695);function c(){var e,s;let{data:t,status:i}=(0,l.useSession)(),[c,o]=(0,a.useState)(!1),x=(0,d.useRouter)(),m=async()=>{await (0,l.signOut)({redirect:!1}),x.push("/")};return(0,r.jsx)("nav",{className:"bg-white shadow-lg",children:(0,r.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[(0,r.jsxs)("div",{className:"flex justify-between h-16",children:[(0,r.jsx)("div",{className:"flex items-center",children:(0,r.jsx)(n(),{href:"/",className:"flex-shrink-0",children:(0,r.jsx)("h1",{className:"text-xl font-bold text-gray-800",children:"专家管理系统"})})}),(0,r.jsxs)("div",{className:"hidden md:flex items-center space-x-4",children:[(0,r.jsx)(n(),{href:"/",className:"text-gray-700 hover:text-gray-900 px-3 py-2 rounded-md text-sm font-medium",children:"专家列表"}),(null==t||null==(e=t.user)?void 0:e.role)==="admin"&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n(),{href:"/experts/create",className:"text-gray-700 hover:text-gray-900 px-3 py-2 rounded-md text-sm font-medium",children:"添加专家"}),(0,r.jsx)(n(),{href:"/experts/import",className:"text-gray-700 hover:text-gray-900 px-3 py-2 rounded-md text-sm font-medium",children:"批量导入"})]}),"loading"===i?(0,r.jsx)("div",{className:"text-gray-500",children:"加载中..."}):t?(0,r.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,r.jsxs)("span",{className:"text-gray-700 text-sm",children:[t.user.email,"admin"===t.user.role&&(0,r.jsx)("span",{className:"ml-1 px-2 py-1 text-xs bg-blue-100 text-blue-800 rounded",children:"管理员"})]}),(0,r.jsx)("button",{onClick:m,className:"bg-red-600 hover:bg-red-700 text-white px-3 py-2 rounded-md text-sm font-medium",children:"退出登录"})]}):(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)(n(),{href:"/auth/signin",className:"text-gray-700 hover:text-gray-900 px-3 py-2 rounded-md text-sm font-medium",children:"登录"}),(0,r.jsx)(n(),{href:"/auth/signup",className:"bg-indigo-600 hover:bg-indigo-700 text-white px-3 py-2 rounded-md text-sm font-medium",children:"注册"})]})]}),(0,r.jsx)("div",{className:"md:hidden flex items-center",children:(0,r.jsx)("button",{onClick:()=>o(!c),className:"text-gray-700 hover:text-gray-900 focus:outline-none focus:text-gray-900",children:(0,r.jsx)("svg",{className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})})})]}),c&&(0,r.jsx)("div",{className:"md:hidden",children:(0,r.jsxs)("div",{className:"px-2 pt-2 pb-3 space-y-1 sm:px-3",children:[(0,r.jsx)(n(),{href:"/",className:"text-gray-700 hover:text-gray-900 block px-3 py-2 rounded-md text-base font-medium",onClick:()=>o(!1),children:"专家列表"}),(null==t||null==(s=t.user)?void 0:s.role)==="admin"&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n(),{href:"/experts/create",className:"text-gray-700 hover:text-gray-900 block px-3 py-2 rounded-md text-base font-medium",onClick:()=>o(!1),children:"添加专家"}),(0,r.jsx)(n(),{href:"/experts/import",className:"text-gray-700 hover:text-gray-900 block px-3 py-2 rounded-md text-base font-medium",onClick:()=>o(!1),children:"批量导入"})]}),t?(0,r.jsxs)("div",{className:"border-t border-gray-200 pt-4",children:[(0,r.jsxs)("div",{className:"px-3 py-2",children:[(0,r.jsx)("div",{className:"text-base font-medium text-gray-800",children:t.user.email}),"admin"===t.user.role&&(0,r.jsx)("div",{className:"text-sm text-blue-600",children:"管理员"})]}),(0,r.jsx)("button",{onClick:()=>{m(),o(!1)},className:"block w-full text-left px-3 py-2 text-base font-medium text-red-600 hover:text-red-800",children:"退出登录"})]}):(0,r.jsxs)("div",{className:"border-t border-gray-200 pt-4 space-y-1",children:[(0,r.jsx)(n(),{href:"/auth/signin",className:"text-gray-700 hover:text-gray-900 block px-3 py-2 rounded-md text-base font-medium",onClick:()=>o(!1),children:"登录"}),(0,r.jsx)(n(),{href:"/auth/signup",className:"bg-indigo-600 hover:bg-indigo-700 text-white block px-3 py-2 rounded-md text-base font-medium",onClick:()=>o(!1),children:"注册"})]})]})})]})})}},5916:(e,s,t)=>{Promise.resolve().then(t.bind(t,9842))},9842:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>x});var r=t(5155),a=t(2115),i=t(2108),n=t(6874),l=t.n(n),d=t(5494);function c(e){let{onSearch:s,placeholder:t="搜索专家姓名、领域、特长...",defaultValue:i=""}=e,[n,l]=(0,a.useState)(i);return(0,r.jsx)("form",{onSubmit:e=>{e.preventDefault(),s(n.trim())},className:"relative",children:(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,r.jsx)("svg",{className:"h-5 w-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),(0,r.jsx)("input",{type:"text",value:n,onChange:e=>l(e.target.value),className:"block w-full pl-10 pr-12 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 text-sm placeholder-gray-500",placeholder:t}),n&&(0,r.jsx)("button",{type:"button",onClick:()=>{l(""),s("")},className:"absolute inset-y-0 right-8 flex items-center pr-2",children:(0,r.jsx)("svg",{className:"h-4 w-4 text-gray-400 hover:text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),(0,r.jsx)("button",{type:"submit",className:"absolute inset-y-0 right-0 flex items-center pr-3",children:(0,r.jsx)("svg",{className:"h-5 w-5 text-indigo-600 hover:text-indigo-800",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})})]})})}function o(e){let{searchQuery:s=""}=e,{data:t}=(0,i.useSession)(),[n,d]=(0,a.useState)([]),[c,o]=(0,a.useState)(null),[x,m]=(0,a.useState)(!0),[h,u]=(0,a.useState)(""),[g,p]=(0,a.useState)(1);(0,a.useEffect)(()=>{f(1)},[s]);let f=async e=>{m(!0);try{let t=new URLSearchParams({page:e.toString(),limit:"10"});s&&t.append("query",s);let r=await fetch("/api/experts?".concat(t)),a=await r.json();r.ok&&a.success?(d(a.data||[]),o(a.pagination||null),p(e)):u(a.error||"获取专家列表失败")}catch(e){u("获取专家列表失败")}finally{m(!1)}},j=e=>{f(e)},b=async e=>{if(confirm("确定要删除这位专家吗？此操作不可撤销。"))try{let s=await fetch("/api/experts/".concat(e),{method:"DELETE"});if(s.ok)f(g);else{let e=await s.json();alert(e.error||"删除失败")}}catch(e){alert("删除失败")}};if(x)return(0,r.jsx)("div",{className:"flex justify-center items-center py-12",children:(0,r.jsx)("div",{className:"text-lg text-gray-600",children:"加载中..."})});if(h)return(0,r.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-md p-4",children:(0,r.jsx)("p",{className:"text-red-800",children:h})});if(0===n.length){var y;return(0,r.jsxs)("div",{className:"text-center py-12",children:[(0,r.jsx)("div",{className:"text-gray-500 text-lg mb-4",children:s?"没有找到匹配的专家":"暂无专家信息"}),(null==t||null==(y=t.user)?void 0:y.role)==="admin"&&!s&&(0,r.jsx)(l(),{href:"/experts/create",className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700",children:"添加第一位专家"})]})}return(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:n.map(e=>{var s;let a=e.field.split(",").map(e=>e.trim()).filter(e=>e),i=e.specialty.split(",").map(e=>e.trim()).filter(e=>e);return(0,r.jsx)("div",{className:"bg-white rounded-lg shadow-md hover:shadow-lg transition-shadow",children:(0,r.jsxs)("div",{className:"p-6",children:[(0,r.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,r.jsxs)("div",{className:"flex items-start space-x-4",children:[e.photoUrl&&(0,r.jsx)("div",{className:"flex-shrink-0",children:(0,r.jsx)("img",{src:e.photoUrl,alt:e.name,className:"w-16 h-16 rounded-full object-cover border border-gray-200"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-xl font-semibold text-gray-900 mb-1",children:(0,r.jsx)(l(),{href:"/experts/".concat(e.id),className:"hover:text-indigo-600 transition-colors",children:e.name})}),e.title&&e.organization&&(0,r.jsxs)("p",{className:"text-gray-600 text-sm",children:[e.title," \xb7 ",e.organization]}),e.title&&!e.organization&&(0,r.jsx)("p",{className:"text-gray-600 text-sm",children:e.title}),!e.title&&e.organization&&(0,r.jsx)("p",{className:"text-gray-600 text-sm",children:e.organization}),e.certificates&&e.certificates.length>0&&(0,r.jsxs)("p",{className:"text-gray-500 text-xs mt-1",children:["\uD83D\uDCDC ",e.certificates.length," 个证书"]})]})]}),(null==t||null==(s=t.user)?void 0:s.role)==="admin"&&(0,r.jsxs)("div",{className:"flex space-x-1",children:[(0,r.jsx)(l(),{href:"/experts/".concat(e.id,"/edit"),className:"text-indigo-600 hover:text-indigo-800 text-sm",children:"编辑"}),(0,r.jsx)("span",{className:"text-gray-300",children:"|"}),(0,r.jsx)("button",{onClick:()=>b(e.id),className:"text-red-600 hover:text-red-800 text-sm",children:"删除"})]})]}),(0,r.jsx)("div",{className:"mb-3",children:(0,r.jsxs)("div",{className:"flex flex-wrap gap-1",children:[a.slice(0,3).map((e,s)=>(0,r.jsx)("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 rounded text-xs",children:e},s)),a.length>3&&(0,r.jsxs)("span",{className:"px-2 py-1 bg-gray-100 text-gray-600 rounded text-xs",children:["+",a.length-3]})]})}),(0,r.jsx)("div",{className:"mb-4",children:(0,r.jsxs)("div",{className:"flex flex-wrap gap-1",children:[i.slice(0,3).map((e,s)=>(0,r.jsx)("span",{className:"px-2 py-1 bg-green-100 text-green-800 rounded text-xs",children:e},s)),i.length>3&&(0,r.jsxs)("span",{className:"px-2 py-1 bg-gray-100 text-gray-600 rounded text-xs",children:["+",i.length-3]})]})}),e.bio&&(0,r.jsx)("p",{className:"text-gray-700 text-sm line-clamp-3 mb-4",children:e.bio}),(0,r.jsx)(l(),{href:"/experts/".concat(e.id),className:"inline-flex items-center text-indigo-600 hover:text-indigo-800 text-sm font-medium",children:"查看详情 →"})]})},e.id)})}),c&&c.totalPages>1&&(0,r.jsxs)("div",{className:"flex justify-center items-center space-x-2",children:[(0,r.jsx)("button",{onClick:()=>j(g-1),disabled:!c.hasPrev,className:"px-3 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"上一页"}),(0,r.jsx)("div",{className:"flex space-x-1",children:Array.from({length:c.totalPages},(e,s)=>s+1).map(e=>(0,r.jsx)("button",{onClick:()=>j(e),className:"px-3 py-2 border rounded-md text-sm font-medium ".concat(e===g?"border-indigo-500 bg-indigo-50 text-indigo-600":"border-gray-300 bg-white text-gray-700 hover:bg-gray-50"),children:e},e))}),(0,r.jsx)("button",{onClick:()=>j(g+1),disabled:!c.hasNext,className:"px-3 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"下一页"})]}),c&&(0,r.jsxs)("div",{className:"text-center text-sm text-gray-600",children:["共 ",c.totalCount," 位专家，第 ",c.currentPage," / ",c.totalPages," 页"]})]})}function x(){var e;let{data:s}=(0,i.useSession)(),[t,n]=(0,a.useState)(""),x=e=>{n(e)};return(0,r.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,r.jsx)(d.A,{}),(0,r.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,r.jsxs)("div",{className:"text-center mb-8",children:[(0,r.jsx)("h1",{className:"text-4xl font-bold text-gray-900 mb-4",children:"专家人员管理系统"}),(0,r.jsx)("p",{className:"text-xl text-gray-600 mb-8",children:"专业的专家人员信息管理与展示平台"})]}),(0,r.jsx)("div",{className:"mb-8",children:(0,r.jsxs)("div",{className:"flex flex-col md:flex-row gap-4 items-center justify-between",children:[(0,r.jsx)("div",{className:"w-full md:w-96",children:(0,r.jsx)(c,{onSearch:x})}),(null==s||null==(e=s.user)?void 0:e.role)==="admin"&&(0,r.jsxs)("div",{className:"flex space-x-4",children:[(0,r.jsxs)(l(),{href:"/experts/create",className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:[(0,r.jsx)("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"添加专家"]}),(0,r.jsxs)(l(),{href:"/experts/import",className:"inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:[(0,r.jsx)("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M9 19l3 3m0 0l3-3m-3 3V10"})}),"批量导入"]})]})]})}),t&&(0,r.jsx)("div",{className:"mb-6",children:(0,r.jsxs)("p",{className:"text-gray-600",children:["搜索结果：",(0,r.jsxs)("span",{className:"font-medium",children:['"',t,'"']}),(0,r.jsx)("button",{onClick:()=>x(""),className:"ml-2 text-indigo-600 hover:text-indigo-800 text-sm",children:"清除搜索"})]})}),(0,r.jsx)(o,{searchQuery:t})]})]})}}},e=>{var s=s=>e(e.s=s);e.O(0,[108,244,441,684,358],()=>s(5916)),_N_E=e.O()}]);